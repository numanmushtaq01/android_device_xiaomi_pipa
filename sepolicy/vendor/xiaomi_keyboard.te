# Keyboard
type xiaomi_keyboard, domain;

type xiaomi_keyboard_exec, exec_type, vendor_file_type, file_type;

init_daemon_domain(xiaomi_keyboard)

get_prop(xiaomi_keyboard, hwservicemanager_prop)
binder_call(xiaomi_keyboard, hwservicemanager)
binder_call(xiaomi_keyboard, system_server)

# Enhanced permissions for keyboard device
allow xiaomi_keyboard xiaomi_keyboard_device:chr_file { getattr open read write ioctl };
allow xiaomi_keyboard fwk_sensor_hwservice:hwservice_manager find;
allow xiaomi_keyboard fwk_sensor_service:service_manager find;

# Enhanced input device permissions
allow xiaomi_keyboard input_device:dir { read search open };
allow xiaomi_keyboard input_device:file { read open getattr };
allow xiaomi_keyboard servicemanager:binder { call transfer };

# Additional diagnostic permissions
allow xiaomi_keyboard sysfs:dir { read open };
allow xiaomi_keyboard sysfs_devices_system_cpu:file { read open };

allow xiaomi_keyboard xiaomi_keyboard_conf_file:file { read open };